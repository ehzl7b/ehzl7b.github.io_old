---
layout: post
title: "윈도우즈 11 SSH 터널링으로 RDP 우회접속 방법"
description: 회사 정책 상, 외부 PC에 윈도우즈 원격 접속(RDP)이 막혔을 때, SSH 터널링으로 우회하여 접속하는 방법 기록
updated: 2024-07-02
---

## RDP 원격 접속

로컬 윈도우즈 PC에서, 외부 윈도우즈 PC에 접속할 때, RDP라는 MS만의 독자적인 방식(?) 또는 앱(?)을 사용하는 것이 가장 좋다.

- RDP 접속
> - "`Windows + R`" -> "mstsc" 실행

이 포스팅에서는 여러가지 이유로 직접 외부 PC에 RDP 접근이 불가능할 때 사용해볼 수 있는 대안인 **SSH 터널링 통한 RDP 우회 접속 방식**을 기록해보고자 한다.

참고로, 로컬PC 외부PC 모두 Windows 11 LTSC 24H2 기준이다.

## 우회 접속 구조

구조에 대해선 어느 전문가가 기록한 [블로그](https://omoknooni.tistory.com/m/73)를 참고하자.

요약하면... 개념적으로는 "로컬 PC ----> SSH 서버 ----> 외부 PC" 순으로 접속하는데, 물리적으로는 외부 PC 안에 SSH 서버를 구축 한다.

사용할 땐, 먼저 로컬 PC에서 SSH 서버에 접속하고(이때 SSH 서버가 외부 PC로 접근가능한 우회통로를 터주게 된다.), 다음으로 로컬 PC에서 우회통로로 RDP 접속을 하면 된다.

## 외부 PC 세팅

- 암호 설정
> 외부 PC에 사용자명, 암호 설정

- SSH 서버 설치
> "시작" -> "설정" -> "시스템" -> "선택적 기능" -> "기능 보기" 버튼 -> "Open SSH 서버" 항목 체크 -> "다음" 버튼

- 재부팅

- SSH 서버 활성화
> "`Windows + R`" -> "services.msc" 실행 -> "OpenSSH Authentication Agent" 항목 열기 -> "시작 유형"을 "자동" 선택 -> "시작" -> "확인"

- 방화벽 설정
> "`Windows + R`" -> "wf.msc" 실행 -> "인바운드 규칙" -> 가장 오른쪽 "새 규칙..." -> 새로운 창에서 "포트" 선택 후 "다음" -> "TCP" 선택 -> "특정 로컬 포트"에 "22" 입력 후 "다음" -> "다음" -> "다음" -> "이름"에 "port 22 개방" 입력 후 "마침"

- 재부팅

## 로컬 PC 세팅

- SSH 실행
> "`Windows + R`" -> "cmd" 실행 -> "ssh -L 8888:127.0.0.1:3389 [외부 PC 사용자명]@[외부 PC 인터넷 주소]" 입력 실행 -> (만일 뭔가 묻는 화면이 나오면 "yes" 입력) -> 비밀번호 입력

여기까지 하면 우회통로가 뚫린다. **프롬프트 창을 닫으면 우회통로도 닫힌다.**

- RDP 접속
> "`Windows + R`" -> "mstsc" 실행 -> "컴퓨터" 항목에 "127.0.0.1:8888" 입력 -> "연결" -> "사용자 이름" 및 "암호" 입력 후 "확인"

SSH 가 만들어준 우회통로 주소인 "127.0.0.1:8888"로 접속하는 식이다.

## 외부 PC 인터넷 주소 확인 또는 생성

참고로 외부 PC 인터넷 주소를 알아내거나, iptime 공유기로 주소 생성하는 방법은 [별도 포스팅](#)에 기록해 두었다.